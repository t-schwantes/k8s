<!DOCTYPE html>
<html lang="en-US"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>JupyterHub Dashboard – BATR</title>
<meta name="robots" content="max-image-preview:large">
<link rel="dns-prefetch" href="http://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="BATR » Feed" href="http://44.240.77.17/feed/">
<link rel="alternate" type="application/rss+xml" title="BATR » Comments Feed" href="http://44.240.77.17/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="BATR » JupyterHub Dashboard Comments Feed" href="http://44.240.77.17/2021/12/29/jupyterhub-dashboard/feed/">
		<script>
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/13.1.0\/svg\/","svgExt":".svg","source":{"concatemoji":"http:\/\/44.240.77.17\/wp-includes\/js\/wp-emoji-release.min.js?ver=5.8.10"}};
			!function(e,a,t){var n,r,o,i=a.createElement("canvas"),p=i.getContext&&i.getContext("2d");function s(e,t){var a=String.fromCharCode;p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,e),0,0);e=i.toDataURL();return p.clearRect(0,0,i.width,i.height),p.fillText(a.apply(this,t),0,0),e===i.toDataURL()}function c(e){var t=a.createElement("script");t.src=e,t.defer=t.type="text/javascript",a.getElementsByTagName("head")[0].appendChild(t)}for(o=Array("flag","emoji"),t.supports={everything:!0,everythingExceptFlag:!0},r=0;r<o.length;r++)t.supports[o[r]]=function(e){if(!p||!p.fillText)return!1;switch(p.textBaseline="top",p.font="600 32px Arial",e){case"flag":return s([127987,65039,8205,9895,65039],[127987,65039,8203,9895,65039])?!1:!s([55356,56826,55356,56819],[55356,56826,8203,55356,56819])&&!s([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]);case"emoji":return!s([10084,65039,8205,55357,56613],[10084,65039,8203,55357,56613])}return!1}(o[r]),t.supports.everything=t.supports.everything&&t.supports[o[r]],"flag"!==o[r]&&(t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&t.supports[o[r]]);t.supports.everythingExceptFlag=t.supports.everythingExceptFlag&&!t.supports.flag,t.DOMReady=!1,t.readyCallback=function(){t.DOMReady=!0},t.supports.everything||(n=function(){t.readyCallback()},a.addEventListener?(a.addEventListener("DOMContentLoaded",n,!1),e.addEventListener("load",n,!1)):(e.attachEvent("onload",n),a.attachEvent("onreadystatechange",function(){"complete"===a.readyState&&t.readyCallback()})),(n=t.source||{}).concatemoji?c(n.concatemoji):n.wpemoji&&n.twemoji&&(c(n.twemoji),c(n.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/wp-emoji-release.min.js" type="text/javascript" defer="defer"></script>
		<style>
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
	<link rel="stylesheet" id="wp-block-library-css" href="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/style.min.css" media="all">
<style id="wp-block-library-theme-inline-css">
#start-resizable-editor-section{display:none}.wp-block-audio figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-audio figcaption{color:hsla(0,0%,100%,.65)}.wp-block-code{font-family:Menlo,Consolas,monaco,monospace;color:#1e1e1e;padding:.8em 1em;border:1px solid #ddd;border-radius:4px}.wp-block-embed figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-embed figcaption{color:hsla(0,0%,100%,.65)}.blocks-gallery-caption{color:#555;font-size:13px;text-align:center}.is-dark-theme .blocks-gallery-caption{color:hsla(0,0%,100%,.65)}.wp-block-image figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-image figcaption{color:hsla(0,0%,100%,.65)}.wp-block-pullquote{border-top:4px solid;border-bottom:4px solid;margin-bottom:1.75em;color:currentColor}.wp-block-pullquote__citation,.wp-block-pullquote cite,.wp-block-pullquote footer{color:currentColor;text-transform:uppercase;font-size:.8125em;font-style:normal}.wp-block-quote{border-left:.25em solid;margin:0 0 1.75em;padding-left:1em}.wp-block-quote cite,.wp-block-quote footer{color:currentColor;font-size:.8125em;position:relative;font-style:normal}.wp-block-quote.has-text-align-right{border-left:none;border-right:.25em solid;padding-left:0;padding-right:1em}.wp-block-quote.has-text-align-center{border:none;padding-left:0}.wp-block-quote.is-large,.wp-block-quote.is-style-large{border:none}.wp-block-search .wp-block-search__label{font-weight:700}.wp-block-group.has-background{padding:1.25em 2.375em;margin-top:0;margin-bottom:0}.wp-block-separator{border:none;border-bottom:2px solid;margin-left:auto;margin-right:auto;opacity:.4}.wp-block-separator:not(.is-style-wide):not(.is-style-dots){width:100px}.wp-block-separator.has-background:not(.is-style-dots){border-bottom:none;height:1px}.wp-block-separator.has-background:not(.is-style-wide):not(.is-style-dots){height:2px}.wp-block-table thead{border-bottom:3px solid}.wp-block-table tfoot{border-top:3px solid}.wp-block-table td,.wp-block-table th{padding:.5em;border:1px solid;word-break:normal}.wp-block-table figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-table figcaption{color:hsla(0,0%,100%,.65)}.wp-block-video figcaption{color:#555;font-size:13px;text-align:center}.is-dark-theme .wp-block-video figcaption{color:hsla(0,0%,100%,.65)}.wp-block-template-part.has-background{padding:1.25em 2.375em;margin-top:0;margin-bottom:0}#end-resizable-editor-section{display:none}
</style>
<link rel="stylesheet" id="copy-the-code-css" href="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/copy-the-code.css" media="all">
<link rel="stylesheet" id="twenty-twenty-one-style-css" href="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/style.css" media="all">
<style id="twenty-twenty-one-style-inline-css">
:root{--global--color-background: #28303d;--global--color-primary: #fff;--global--color-secondary: #fff;--button--color-background: #fff;--button--color-text-hover: #fff;--table--stripes-border-color: rgba(240, 240, 240, 0.15);--table--stripes-background-color: rgba(240, 240, 240, 0.15);}
</style>
<link rel="stylesheet" id="twenty-twenty-one-print-style-css" href="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/print.css" media="print">
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/jquery.min.js" id="jquery-core-js"></script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/jquery-migrate.min.js" id="jquery-migrate-js"></script>
<link rel="https://api.w.org/" href="http://44.240.77.17/wp-json/"><link rel="alternate" type="application/json" href="http://44.240.77.17/wp-json/wp/v2/posts/134"><link rel="EditURI" type="application/rsd+xml" title="RSD" href="http://44.240.77.17/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="http://44.240.77.17/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 5.8.10">
<link rel="canonical" href="http://44.240.77.17/2021/12/29/jupyterhub-dashboard/">
<link rel="shortlink" href="http://44.240.77.17/?p=134">
<link rel="alternate" type="application/json+oembed" href="http://44.240.77.17/wp-json/oembed/1.0/embed?url=http%3A%2F%2F44.240.77.17%2F2021%2F12%2F29%2Fjupyterhub-dashboard%2F">
<link rel="alternate" type="text/xml+oembed" href="http://44.240.77.17/wp-json/oembed/1.0/embed?url=http%3A%2F%2F44.240.77.17%2F2021%2F12%2F29%2Fjupyterhub-dashboard%2F&amp;format=xml">
<link rel="pingback" href="http://44.240.77.17/xmlrpc.php"><style id="custom-background-css">
body.custom-background { background-color: #28303d; }
</style>
	</head>

<body class="post-template-default single single-post postid-134 single-format-standard custom-background wp-embed-responsive is-dark-theme singular has-main-navigation">
<div id="page" class="site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
<header id="masthead" class="site-header has-title-and-tagline has-menu" role="banner">

	

<div class="site-branding">

	
						<p class="site-title"><a href="http://44.240.77.17/">BATR</a></p>
			
			<p class="site-description">
			My Technical Reference		</p>
	</div><!-- .site-branding -->
	
	<nav id="site-navigation" class="primary-navigation" role="navigation" aria-label="Primary menu">
		<div class="menu-button-container">
			<button id="primary-mobile-menu" class="button" aria-controls="primary-menu-list" aria-expanded="false">
				<span class="dropdown-icon open">Menu					<svg class="svg-icon" width="24" height="24" aria-hidden="true" role="img" focusable="false" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M4.5 6H19.5V7.5H4.5V6ZM4.5 12H19.5V13.5H4.5V12ZM19.5 18H4.5V19.5H19.5V18Z" fill="currentColor"></path></svg>				</span>
				<span class="dropdown-icon close">Close					<svg class="svg-icon" width="24" height="24" aria-hidden="true" role="img" focusable="false" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M12 10.9394L5.53033 4.46973L4.46967 5.53039L10.9393 12.0001L4.46967 18.4697L5.53033 19.5304L12 13.0607L18.4697 19.5304L19.5303 18.4697L13.0607 12.0001L19.5303 5.53039L18.4697 4.46973L12 10.9394Z" fill="currentColor"></path></svg>				</span>
			</button><!-- #primary-mobile-menu -->
		</div><!-- .menu-button-container -->
		<div class="primary-menu-container"><ul id="primary-menu-list" class="menu-wrapper"><li id="menu-item-14" class="menu-item menu-item-type-custom menu-item-object-custom menu-item-home menu-item-14"><a href="http://44.240.77.17/">Home</a></li>
<li id="menu-item-15" class="menu-item menu-item-type-post_type menu-item-object-page current_page_parent menu-item-15"><a href="http://44.240.77.17/blog/">Blog</a></li>
</ul></div>	</nav><!-- #site-navigation -->

</header><!-- #masthead -->

	<div id="content" class="site-content">
		<div id="primary" class="content-area">
			<main id="main" class="site-main" role="main">

<article id="post-134" class="post-134 post type-post status-publish format-standard hentry category-uncategorized entry">

	<header class="entry-header alignwide">
		<h1 class="entry-title">JupyterHub Dashboard</h1>			</header><!-- .entry-header -->

	<div class="entry-content">
		
<p>This is a simple web app that provides a dashboard view of users and the GPU resources they are currently utilizing. </p>



<p>Built as a Flask app there are three files that make up the entire 
project. First, the primary application file contains the following.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-1" data-shcb-language-name="Python" data-shcb-language-slug="python"><link rel="stylesheet" id="syntax-highlighting-code-block-css" href="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/a11y-dark.css" media="all"><style>.wp-block-code {
	border: 0;
	padding: 0;
}

.wp-block-code > div {
	overflow: auto;
}

.shcb-language {
	border: 0;
	clip: rect(1px, 1px, 1px, 1px);
	-webkit-clip-path: inset(50%);
	clip-path: inset(50%);
	height: 1px;
	margin: -1px;
	overflow: hidden;
	padding: 0;
	position: absolute;
	width: 1px;
	word-wrap: normal;
	word-break: normal;
}

.hljs {
	box-sizing: border-box;
}

.hljs.shcb-code-table {
	display: table;
	width: 100%;
}

.hljs.shcb-code-table > .shcb-loc {
	color: inherit;
	display: table-row;
	width: 100%;
}

.hljs.shcb-code-table .shcb-loc > span {
	display: table-cell;
}

.wp-block-code code.hljs:not(.shcb-wrap-lines) {
	white-space: pre;
}

.wp-block-code code.hljs.shcb-wrap-lines {
	white-space: pre-wrap;
}

.hljs.shcb-line-numbers {
	border-spacing: 0;
	counter-reset: line;
}

.hljs.shcb-line-numbers > .shcb-loc {
	counter-increment: line;
}

.hljs.shcb-line-numbers .shcb-loc > span {
	padding-left: 0.75em;
}

.hljs.shcb-line-numbers .shcb-loc::before {
	border-right: 1px solid #ddd;
	content: counter(line);
	display: table-cell;
	padding: 0 0.75em;
	text-align: right;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	user-select: none;
	white-space: nowrap;
	width: 1%;
}
</style><div><code class="hljs language-python shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-keyword">from</span> flask <span class="hljs-keyword">import</span> Flask, render_template
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">import</span> subprocess
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">import</span> re
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">from</span> io <span class="hljs-keyword">import</span> StringIO
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">import</span> csv
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">import</span> json
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">import</span> pprint
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>pp = pprint.PrettyPrinter()
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>app = Flask(__name__)
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_jupyter_pods</span><span class="hljs-params">()</span>:</span>
</span></span><span class="shcb-loc"><span>        pods = []
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">try</span>:
</span></span><span class="shcb-loc"><span>                process = subprocess.run(
</span></span><span class="shcb-loc"><span>                        [<span class="hljs-string">'kubectl'</span>, <span class="hljs-string">'get'</span>, <span class="hljs-string">'pods'</span>, <span class="hljs-string">'-n'</span>, <span class="hljs-string">'jhub'</span>],
</span></span><span class="shcb-loc"><span>                        stdout=subprocess.PIPE)
</span></span><span class="shcb-loc"><span>                pod_info = process.stdout.decode(<span class="hljs-string">'utf-8'</span>)
</span></span><span class="shcb-loc"><span>                pod_info_squeeze = re.sub(<span class="hljs-string">r' {2,}'</span>, <span class="hljs-string">' '</span>, pod_info)
</span></span><span class="shcb-loc"><span>                f = StringIO(pod_info_squeeze)
</span></span><span class="shcb-loc"><span>                reader = csv.DictReader(f, delimiter=<span class="hljs-string">' '</span>)
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">for</span> row <span class="hljs-keyword">in</span> reader:
</span></span><span class="shcb-loc"><span>                        <span class="hljs-keyword">if</span> <span class="hljs-string">'jupyter'</span> <span class="hljs-keyword">in</span> row[<span class="hljs-string">'NAME'</span>]:
</span></span><span class="shcb-loc"><span>                                pods.append(row[<span class="hljs-string">'NAME'</span>])
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">except</span>:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">return</span> []
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">return</span> pods
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pod_data</span><span class="hljs-params">(name)</span>:</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">try</span>:
</span></span><span class="shcb-loc"><span>                process = subprocess.run(
</span></span><span class="shcb-loc"><span>                        [<span class="hljs-string">'kubectl'</span>, <span class="hljs-string">'get'</span>, <span class="hljs-string">'pod'</span>, name, <span class="hljs-string">'-n'</span>, <span class="hljs-string">'jhub'</span>, <span class="hljs-string">'-o'</span>, <span class="hljs-string">'json'</span>],
</span></span><span class="shcb-loc"><span>                        stdout=subprocess.PIPE)
</span></span><span class="shcb-loc"><span>                obj = process.stdout.decode(<span class="hljs-string">'utf-8'</span>)
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">return</span> json.loads(obj)
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">except</span>:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pod_user</span><span class="hljs-params">(pod)</span>:</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> pod[<span class="hljs-string">'spec'</span>][<span class="hljs-string">'containers'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'env'</span>]:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">if</span> item[<span class="hljs-string">'name'</span>] == <span class="hljs-string">'JUPYTERHUB_USER'</span>:
</span></span><span class="shcb-loc"><span>                        <span class="hljs-keyword">return</span> item[<span class="hljs-string">'value'</span>]
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pod_image</span><span class="hljs-params">(pod)</span>:</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">for</span> item <span class="hljs-keyword">in</span> pod[<span class="hljs-string">'spec'</span>][<span class="hljs-string">'containers'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'env'</span>]:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">if</span> item[<span class="hljs-string">'name'</span>] == <span class="hljs-string">'JUPYTER_IMAGE'</span>:
</span></span><span class="shcb-loc"><span>                        <span class="hljs-keyword">return</span> item[<span class="hljs-string">'value'</span>]
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pod_node</span><span class="hljs-params">(pod)</span>:</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">return</span> pod[<span class="hljs-string">'spec'</span>][<span class="hljs-string">'nodeName'</span>]
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_pod_gpus</span><span class="hljs-params">(pod)</span>:</span>
</span></span><span class="shcb-loc"><span>        resource_requests = pod[<span class="hljs-string">'spec'</span>][<span class="hljs-string">'containers'</span>][<span class="hljs-number">0</span>][<span class="hljs-string">'resources'</span>][<span class="hljs-string">'requests'</span>]
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">if</span> <span class="hljs-string">'nvidia.com/gpu'</span> <span class="hljs-keyword">in</span> resource_requests:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">return</span> resource_requests[<span class="hljs-string">'nvidia.com/gpu'</span>]
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">else</span>:
</span></span><span class="shcb-loc"><span>                <span class="hljs-keyword">return</span> <span class="hljs-literal">None</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-meta">@app.route('/')</span>
</span></span><span class="shcb-loc"><span><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">dashboard</span><span class="hljs-params">()</span>:</span>
</span></span><span class="shcb-loc"><span>        data = []
</span></span><span class="shcb-loc"><span>        pods = get_jupyter_pods()
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">for</span> pod <span class="hljs-keyword">in</span> pods:
</span></span><span class="shcb-loc"><span>                pod_data = get_pod_data(pod)
</span></span><span class="shcb-loc"><span>                user = get_pod_user(pod_data)
</span></span><span class="shcb-loc"><span>                image = get_pod_image(pod_data)
</span></span><span class="shcb-loc"><span>                node = get_pod_node(pod_data)
</span></span><span class="shcb-loc"><span>                gpus = get_pod_gpus(pod_data)
</span></span><span class="shcb-loc"><span>                data.append({
</span></span><span class="shcb-loc"><span>                        <span class="hljs-string">'user'</span>: user,
</span></span><span class="shcb-loc"><span>                        <span class="hljs-string">'image'</span>: image,
</span></span><span class="shcb-loc"><span>                        <span class="hljs-string">'node'</span>: node,
</span></span><span class="shcb-loc"><span>                        <span class="hljs-string">'gpus'</span>: gpus
</span></span><span class="shcb-loc"><span>                })
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-keyword">return</span> render_template(<span class="hljs-string">'dashboard.html'</span>, data=data)
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">'__main__'</span>:
</span></span><span class="shcb-loc"><span>        app.run(host=<span class="hljs-string">'0.0.0.0'</span>, port=<span class="hljs-number">8080</span>)
</span></span></code></div><small class="shcb-language" id="shcb-language-1"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Python</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">python</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>


<p>The second is a simple css style file with the following contents. It should be located in <code>static/style.css</code>.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-2" data-shcb-language-name="CSS" data-shcb-language-slug="css"><div><code class="hljs language-css shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-selector-tag">h1</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">20px</span>;
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-selector-tag">table</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">border-collapse</span>: collapse;
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-selector-tag">div</span><span class="hljs-selector-class">.table</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">padding-left</span>: <span class="hljs-number">20px</span>;
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-selector-tag">td</span>, <span class="hljs-selector-tag">th</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">text-align</span>: left;
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">padding</span>: <span class="hljs-number">15px</span> <span class="hljs-number">10px</span> <span class="hljs-number">15px</span> <span class="hljs-number">10px</span>;
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">border</span>: <span class="hljs-number">0px</span>;
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">border-bottom</span>: <span class="hljs-number">1px</span> solid <span class="hljs-number">#ddd</span>;
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-selector-tag">th</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#444</span>;
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">color</span>: white;
</span></span><span class="shcb-loc"><span>}
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-selector-tag">tr</span><span class="hljs-selector-pseudo">:hover</span> {
</span></span><span class="shcb-loc"><span>    <span class="hljs-attribute">background-color</span>: <span class="hljs-number">#eee</span>;
</span></span><span class="shcb-loc"><span>}
</span></span></code></div><small class="shcb-language" id="shcb-language-2"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">CSS</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">css</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>


<p>The final file is an html template with the following contents. It should be located in <code>templates/dashboard.html</code>.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-3" data-shcb-language-name="HTML, XML" data-shcb-language-slug="xml"><div><code class="hljs language-xml shcb-code-table shcb-line-numbers"><span class="shcb-loc"><span><span class="hljs-meta">&lt;!doctype <span class="hljs-meta-keyword">html</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">html</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">head</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">link</span> <span class="hljs-attr">rel</span>=<span class="hljs-string">"stylesheet"</span> <span class="hljs-attr">href</span>=<span class="hljs-string">"static/style.css"</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;/<span class="hljs-name">head</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">title</span>&gt;</span>JupyterHub Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">title</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">h1</span>&gt;</span>JupyterHub Dashboard<span class="hljs-tag">&lt;/<span class="hljs-name">h1</span>&gt;</span>
</span></span><span class="shcb-loc"><span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;<span class="hljs-name">div</span> <span class="hljs-attr">class</span>=<span class="hljs-string">"table"</span>&gt;</span>
</span></span><span class="shcb-loc"><span>    {% if data %}
</span></span><span class="shcb-loc"><span>    <span class="hljs-tag">&lt;<span class="hljs-name">table</span>&gt;</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>User<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Node<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>GPUs<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">th</span>&gt;</span>Image<span class="hljs-tag">&lt;/<span class="hljs-name">th</span>&gt;</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</span></span><span class="shcb-loc"><span>        {% for item in data %}
</span></span><span class="shcb-loc"><span>        <span class="hljs-tag">&lt;<span class="hljs-name">tr</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ item['user'] }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ item['node'] }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ item['gpus'] }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
</span></span><span class="shcb-loc"><span>            <span class="hljs-tag">&lt;<span class="hljs-name">td</span>&gt;</span>{{ item['image'] }}<span class="hljs-tag">&lt;/<span class="hljs-name">td</span>&gt;</span>
</span></span><span class="shcb-loc"><span>        <span class="hljs-tag">&lt;/<span class="hljs-name">tr</span>&gt;</span>
</span></span><span class="shcb-loc"><span>        {% endfor %}
</span></span><span class="shcb-loc"><span>    <span class="hljs-tag">&lt;/<span class="hljs-name">table</span>&gt;</span>
</span></span><span class="shcb-loc"><span>    {% else %}
</span></span><span class="shcb-loc"><span>    <span class="hljs-tag">&lt;<span class="hljs-name">div</span>&gt;</span>No launched servers<span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></span><span class="shcb-loc"><span>    {% endif %}
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;/<span class="hljs-name">div</span>&gt;</span>
</span></span><span class="shcb-loc"><span><span class="hljs-tag">&lt;/<span class="hljs-name">html</span>&gt;</span>
</span></span></code></div><small class="shcb-language" id="shcb-language-3"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">HTML, XML</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">xml</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>


<p>The web app can be run with the following command.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-4" data-shcb-language-name="CSS" data-shcb-language-slug="css"><div><code class="hljs language-css"><span class="hljs-selector-tag">python</span> <span class="hljs-selector-tag">dashboard-app</span><span class="hljs-selector-class">.py</span></code></div><small class="shcb-language" id="shcb-language-4"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">CSS</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">css</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>


<p>Alternatively, the app can be run automatically on reboot as a service. Create the file <code>/etc/systemd/system/jupyterhub-dashboard.service</code> with the following contents.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-5" data-shcb-language-name="Bash" data-shcb-language-slug="bash"><div><code class="hljs language-bash">[Unit]
Description=Web app that displays a simple dashboard describing the utilization of JupyterHub resources.

[Service]
User=[username]
WorkingDirectory=/path/to/app/dir
ExecStart=/usr/bin/python3 /path/to/app/dashboard-app.py

[Install]
WantedBy=multi-user.target</code></div><small class="shcb-language" id="shcb-language-5"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Bash</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">bash</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>


<p>Then run the following commands to enable the service.</p>


<span data-button-text="Copy" data-button-position="inside" data-button-copy-text="Copied!" data-style="button" data-button-title="Copy to Clipboard" data-selector="pre" class="copy-the-code-wrap copy-the-code-style-button copy-the-code-inside-wrap"><pre class="wp-block-code copy-the-code-target" aria-describedby="shcb-language-6" data-shcb-language-name="Bash" data-shcb-language-slug="bash"><div><code class="hljs language-bash">sudo systemctl <span class="hljs-built_in">enable</span> jupyterhub-dashboard.service
service jupyterhub-dashboard start
service jupyterhub-dashboard status</code></div><small class="shcb-language" id="shcb-language-6"><span class="shcb-language__label">Code language:</span> <span class="shcb-language__name">Bash</span> <span class="shcb-language__paren">(</span><span class="shcb-language__slug">bash</span><span class="shcb-language__paren">)</span></small><button class="copy-the-code-button" data-style="button" title="Copy to Clipboard">Copy</button></pre></span>	</div><!-- .entry-content -->

	<footer class="entry-footer default-max-width">
		<div class="posted-by"><span class="posted-on">Published <time class="entry-date published updated" datetime="2021-12-29T19:53:56+00:00">December 29, 2021</time></span><span class="byline">By <a href="http://44.240.77.17/author/bentarnold/" rel="author">Ben Arnold</a></span></div><div class="post-taxonomies"><span class="cat-links">Categorized as <a href="http://44.240.77.17/category/uncategorized/" rel="category tag">Uncategorized</a> </span></div>	</footer><!-- .entry-footer -->

				
</article><!-- #post-134 -->

<div id="comments" class="comments-area default-max-width show-avatars">

	
		<div id="respond" class="comment-respond">
		<h2 id="reply-title" class="comment-reply-title">Leave a comment <small><a rel="nofollow" id="cancel-comment-reply-link" href="http://44.240.77.17/2021/12/29/jupyterhub-dashboard/#respond" style="display:none;">Cancel reply</a></small></h2><form action="http://44.240.77.17/wp-comments-post.php" method="post" id="commentform" class="comment-form" novalidate=""><p class="comment-notes"><span id="email-notes">Your email address will not be published.</span> Required fields are marked <span class="required">*</span></p><p class="comment-form-comment"><label for="comment">Comment</label> <textarea id="comment" name="comment" cols="45" rows="5" maxlength="65525" required="required"></textarea></p><p class="comment-form-author"><label for="author">Name <span class="required">*</span></label> <input id="author" name="author" type="text" size="30" maxlength="245" required="required"></p>
<p class="comment-form-email"><label for="email">Email <span class="required">*</span></label> <input id="email" name="email" type="email" size="30" maxlength="100" aria-describedby="email-notes" required="required"></p>
<p class="comment-form-url"><label for="url">Website</label> <input id="url" name="url" type="url" size="30" maxlength="200"></p>
<p class="comment-form-cookies-consent"><input id="wp-comment-cookies-consent" name="wp-comment-cookies-consent" type="checkbox" value="yes"> <label for="wp-comment-cookies-consent">Save my name, email, and website in this browser for the next time I comment.</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Post Comment"> <input type="hidden" name="comment_post_ID" value="134" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p></form>	</div><!-- #respond -->
	
</div><!-- #comments -->

	<nav class="navigation post-navigation" role="navigation" aria-label="Posts">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="http://44.240.77.17/2021/10/26/update-proxy-routing-table/" rel="prev"><p class="meta-nav"><svg class="svg-icon" width="24" height="24" aria-hidden="true" role="img" focusable="false" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M20 13v-2H8l4-4-1-2-7 7 7 7 1-2-4-4z" fill="currentColor"></path></svg>Previous post</p><p class="post-title">Tensorboard Support</p></a></div></div>
	</nav>			</main><!-- #main -->
		</div><!-- #primary -->
	</div><!-- #content -->

	
	<aside class="widget-area">
		<section id="block-2" class="widget widget_block widget_search"><form role="search" method="get" action="http://44.240.77.17/" class="wp-block-search__button-outside wp-block-search__text-button wp-block-search"><label for="wp-block-search__input-1" class="wp-block-search__label">Search</label><div class="wp-block-search__inside-wrapper"><input type="search" id="wp-block-search__input-1" class="wp-block-search__input" name="s" placeholder="" required=""><button type="submit" class="wp-block-search__button ">Search</button></div></form></section><section id="block-4" class="widget widget_block"><div class="wp-block-group"><div class="wp-block-group__inner-container"><h2>Recent Comments</h2><div class="no-comments wp-block-latest-comments">No comments to show.</div></div></div></section>	</aside><!-- .widget-area -->


	<footer id="colophon" class="site-footer" role="contentinfo">

				<div class="site-info">
			<div class="site-name">
																						<a href="http://44.240.77.17/">BATR</a>
																		</div><!-- .site-name -->
			<div class="powered-by">
				Proudly powered by <a href="https://wordpress.org/">WordPress</a>.			</div><!-- .powered-by -->

		</div><!-- .site-info -->
	</footer><!-- #colophon -->

</div><!-- #page -->

<script>document.body.classList.remove("no-js");</script>	<script>
	if ( -1 !== navigator.userAgent.indexOf( 'MSIE' ) || -1 !== navigator.appVersion.indexOf( 'Trident/' ) ) {
		document.body.classList.add( 'is-IE' );
	}
	</script>
	<script id="copy-the-code-js-extra">
var copyTheCode = {"copy_content_as":"","previewMarkup":"<h2>Hello World<\/h2>","buttonMarkup":"<button class=\"copy-the-code-button\" title=\"\"><\/button>","buttonSvg":"<svg viewBox=\"-21 0 512 512\" xmlns=\"http:\/\/www.w3.org\/2000\/svg\"><path d=\"m186.667969 416c-49.984375 0-90.667969-40.683594-90.667969-90.667969v-218.664062h-37.332031c-32.363281 0-58.667969 26.300781-58.667969 58.664062v288c0 32.363281 26.304688 58.667969 58.667969 58.667969h266.664062c32.363281 0 58.667969-26.304688 58.667969-58.667969v-37.332031zm0 0\"><\/path><path d=\"m469.332031 58.667969c0-32.40625-26.261719-58.667969-58.664062-58.667969h-224c-32.40625 0-58.667969 26.261719-58.667969 58.667969v266.664062c0 32.40625 26.261719 58.667969 58.667969 58.667969h224c32.402343 0 58.664062-26.261719 58.664062-58.667969zm0 0\"><\/path><\/svg>","selectors":[{"selector":"pre","style":"button","button_text":"Copy","button_title":"Copy to Clipboard","button_copy_text":"Copied!","button_position":"inside"}],"selector":"pre","settings":{"selector":"pre","button-text":"Copy","button-title":"Copy to Clipboard","button-copy-text":"Copied!","button-position":"inside"},"string":{"title":"Copy to Clipboard","copy":"Copy","copied":"Copied!"},"image-url":"http:\/\/44.240.77.17\/wp-content\/plugins\/copy-the-code\/\/assets\/images\/copy-1.svg"};
</script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/copy-the-code.js" id="copy-the-code-js"></script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/comment-reply.min.js" id="comment-reply-js"></script>
<script id="twenty-twenty-one-ie11-polyfills-js-after">
( Element.prototype.matches && Element.prototype.closest && window.NodeList && NodeList.prototype.forEach ) || document.write( '<script src="http://44.240.77.17/wp-content/themes/twentytwentyone/assets/js/polyfills.js?ver=1.4"></scr' + 'ipt>' );
</script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/primary-navigation.js" id="twenty-twenty-one-primary-navigation-script-js"></script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/responsive-embeds.js" id="twenty-twenty-one-responsive-embeds-script-js"></script>
<script src="JupyterHub%20Dashboard%20%E2%80%93%20BATR_files/wp-embed.min.js" id="wp-embed-js"></script>
	<script>
	/(trident|msie)/i.test(navigator.userAgent)&&document.getElementById&&window.addEventListener&&window.addEventListener("hashchange",(function(){var t,e=location.hash.substring(1);/^[A-z0-9_-]+$/.test(e)&&(t=document.getElementById(e))&&(/^(?:a|select|input|button|textarea)$/i.test(t.tagName)||(t.tabIndex=-1),t.focus())}),!1);
	</script>
	


</body></html>